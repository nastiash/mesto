
/*** –≠–õ–ï–ú–ï–ù–¢–´ –ü–†–û–§–ò–õ–Ø ***/
const editProfileButton = document.querySelector(".profile__edit-button");
const addNewCardButton = document.querySelector(".profile__add-button");
const profileName = document.querySelector(".profile__name");
const profileCaption = document.querySelector(".profile__caption");

/*** –≠–õ–ï–ú–ï–ù–¢–´ –ö–ê–†–¢–û–ß–ï–ö ***/
const cardsContainerElement = document.querySelector(".cards");
const cardTemplateElement = document.querySelector(".card-template");

/*** –≠–õ–ï–ú–ï–ù–¢–´ –§–û–†–ú ***/
const form = document.querySelector(".pop-up__form");
const formElement = document.querySelector(".pop-up__form-container");
const formInput = formElement.querySelector(".pop-up__form-input");
// –í—ã–±–∏—Ä–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –æ—à–∏–±–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞
const formError = formElement.querySelector(`.pop-up__form-${formInput.id}-error`);
console.log(formInput.id);
console.log(formError);

/*** –ü–û–ü-–ê–ü –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø –ü–†–û–§–ò–õ–Ø ***/
const editProfilePopup = document.querySelector(".pop-up_content_edit-profile");
const editProfileForm = document.querySelector(".pop-up__form_content_edit-profile");
const editProfileCloseButton = document.querySelector(".pop-up__close-button_content_edit");
const editProfileInputName = document.querySelector(".pop-up__form-input_el_name");
const editProfileInputCaption = document.querySelector(".pop-up__form-input_el_caption");

/*** –ü–û–ü-–ê–ü –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ö–ê–†–¢–û–ß–ö–ò ***/
const addNewCardPopup = document.querySelector(".pop-up_content_add-card");
const addNewCardForm = document.querySelector(".pop-up__form_content_add-card");
const addNewCardCloseButton = document.querySelector(".pop-up__close-button_content_add-card");
const addNewCardInputTitle = document.querySelector(".pop-up__form-input_el_place");
const addNewCardInputLink = document.querySelector(".pop-up__form-input_el_link");

/*** –ü–û–ü-–ê–ü –§–£–õ–õ-–°–ê–ô–ó –§–û–¢–ö–ò ***/
const fullSizeImagePopup = document.querySelector(".pop-up_content_image");
const fullSizeImageCloseButton = document.querySelector(".pop-up__close-button_content_image");
const fullSizeImagePopupCaption = document.querySelector(".pop-up__text");
const fullSizeImagePopupPhoto = document.querySelector(".pop-up__big-image");


// –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–æ–≤
const openPopup = (popup) => {
  popup.classList.add("pop-up_opened");
  document.addEventListener("keyup", closePopupWithEsc);
  popup.addEventListener("click", closePopupWithOverlayClick);
};

// –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–æ–≤
const closePopup = (popup) => {
  popup.classList.remove("pop-up_opened");
  document.removeEventListener("keyup", closePopupWithEsc);
  popup.removeEventListener("click", closePopupWithOverlayClick);
};

// –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–æ–≤ —á–µ—Ä–µ–∑ ESC
const closePopupWithEsc = (event) => {
  const activePopup = document.querySelector(".pop-up_opened");
  if (event.key === "Escape") closePopup(activePopup);
};

//–∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–æ–≤ –∫–ª–∏–∫–æ–º –ø–æ –æ–≤–µ—Ä–ª–µ—é
const closePopupWithOverlayClick = (event) => {
  const activePopup = event.target;
  if (activePopup.closest(".pop-up__container")) event.stopPropagation();
  else if (activePopup.closest(".pop-up")) closePopup(activePopup);
};

// –∑–∞–ø–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ—Ñ–∏–ª—å
function submitEditProfileForm(event) {
  event.preventDefault();
  profileName.textContent = editProfileInputName.value;
  profileCaption.textContent = editProfileInputCaption.value;
  closePopup(editProfilePopup);
}

//–º–∞—Å—Å–∏–≤ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
const initialCards = [
  {
    name: "–ë–∏–∫–∏–Ω–∏ –ë–æ—Ç—Ç–æ–º",
    link: "https://i.ibb.co/NLKw6WG/bikini-bottom.jpg",
  },
  {
    name: "–ö—Ä–∞—Å—Ç–∏ –ü–ª–∞–Ω–∫—Ç–æ–Ω",
    link: "https://i.ibb.co/c8Ct20y/krusty-plankton.jpg",
  },
  {
    name: "–¢—é—Ä—å–º–∞ üò±",
    link: "https://i.ibb.co/HBqnT4G/Jail.jpg",
  },
  {
    name: "–ü–æ–ª—è –º–µ–¥—É–∑",
    link: "https://i.ibb.co/7JKD50c/jellyfish-fields.jpg",
  },
  {
    name: "–î–æ–º –ë–µ–ª–∫–∏",
    link: "https://i.ibb.co/QJ5QGWY/squirrel.jpg",
  },
  {
    name: "–ö—Ä–∞—Å—Ç–∏ –ö—Ä–∞–±",
    link: "https://i.ibb.co/znZGSMp/krusty-krab.jpg",
  },
];

//—É–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
function deleteCard(event) {
  event.target.closest(".card").remove();
}

//—Å–æ–±—Ä–∞—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç—å –ø–æ–ø–∞–ø –±–æ–ª—å—à–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏
const composeFullSizeImagePopup = (name, link) => {
  openPopup(fullSizeImagePopup);
  fullSizeImagePopupCaption.textContent = name;
  fullSizeImagePopupPhoto.src = link;
  fullSizeImagePopupPhoto.alt = name;
};

//—Å–æ–±—Ä–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
function composeCard({ name, link }) {
  const newItem = cardTemplateElement.content.cloneNode(true);
  const cardTitle = newItem.querySelector(".card__title");
  const cardPhoto = newItem.querySelector(".card__photo");
  const cardLike = newItem.querySelector(".card__like-button");
  const cardDeleteButton = newItem.querySelector(".card__delete-button");
  cardTitle.textContent = name;
  cardPhoto.src = link;
  cardPhoto.alt = name;
  //–æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞ —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π
  cardPhoto.addEventListener("click", () => {
    composeFullSizeImagePopup(name, link);
  });
  //–ª–∞–π–∫
  cardLike.addEventListener("click", () => {
    cardLike.classList.toggle("card__like-button_active");
  });
  //—É–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
  cardDeleteButton.addEventListener("click", deleteCard);
  return newItem;
}

//–æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
function renderCardList() {
  const cardItems = initialCards.map(composeCard);
  cardsContainerElement.append(...cardItems);
}

renderCardList();

//–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
function addNewCard(event) {
  event.preventDefault();
  const newCard = composeCard({ name: addNewCardInputTitle.value, link: addNewCardInputLink.value });
  cardsContainerElement.prepend(newCard);
  addNewCardInputTitle.value = "";
  addNewCardInputLink.value = "";
  closePopup(addNewCardPopup);
}

/*
//–≤–∞–ª–∏–¥–∞—Ü–∏—è
// –≤–∫–ª—é—á–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—ã–∑–æ–≤–æ–º enableValidation
// –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ

enableValidation({
  formSelector: '.popup__form',
  inputSelector: '.popup__input',
  submitButtonSelector: '.popup__button',
  inactiveButtonClass: 'popup__button_disabled',
  inputErrorClass: 'popup__input_type_error',
  errorClass: 'popup__error_visible'
});
*/

// –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å —Å –æ—à–∏–±–∫–æ–π
const showInputError = (formElement, inputElement, errorMessage) => {
  const errorElement = formElement.querySelector(`#${inputElement.id}-error`);
  console.log(inputElement.id);
  formElement.classList.add('pop-up__form-input_type_error');
  errorElement.textContent = errorMessage;
  errorElement.classList.add('pop-up__form-input-error_active');
};

// –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —É–¥–∞–ª—è–µ—Ç –∫–ª–∞—Å—Å —Å –æ—à–∏–±–∫–æ–π
const hideInputError = (formElement, inputElement) => {
  const errorElement = formElement.querySelector(`#${inputElement.id}-error`);
  formElement.classList.remove('pop-up__form-input_type_error');
  errorElement.classList.remove('pop-up__form-input-error_active');
  errorElement.textContent = '';
};

// –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø–æ–ª—è
const checkInputValidity = () => {
  if (!formInput.validity.valid) {
    showInputError(form, formInput, formInput.validationMessage);
} else {
  hideInputError(form, formInput);
  }
};

//—Å–ª—É—à–∞—Ç–µ–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏


form.addEventListener('submit', function (evt) {
  evt.preventDefault();
});

formInput.addEventListener('input', function () {
  checkInputValidity();
});
/*

formInput.addEventListener('input', isValid);

editProfileForm.addEventListener('submit', function (event) {
  event.preventDefault();
});

addNewCardForm.addEventListener('submit', function (event) {
  event.preventDefault();
});

addNewCardInputTitle.addEventListener('input', function (event) {
  console.log(event.target.validity);
});

addNewCardInputLink.addEventListener('input', function (event) {
  console.log(event.target.validity);
});

editProfileInputName.addEventListener('input', function (event) {
  console.log(event.target.validity);
});

editProfileInputCaption.addEventListener('input', function (event) {
  console.log(event.target.validity);
});

*/















//—Å–ª—É—à–∞—Ç–µ–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–æ–≤
editProfileButton.addEventListener("click", () => {
  openPopup(editProfilePopup);
  //–∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã
  editProfileInputName.value = profileName.textContent;
  editProfileInputCaption.value = profileCaption.textContent;
});

addNewCardButton.addEventListener("click", () => {
  openPopup(addNewCardPopup);
});

//—Å–ª—É—à–∞—Ç–µ–ª–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–æ–≤
editProfileCloseButton.addEventListener("click", () => {
  closePopup(editProfilePopup);
});

addNewCardCloseButton.addEventListener("click", () => {
  closePopup(addNewCardPopup);
});

fullSizeImageCloseButton.addEventListener("click", () => {
  closePopup(fullSizeImagePopup);
});

//—Å–ª—É—à–∞—Ç–µ–ª–∏ —Å–∞–±–º–∏—Ç–æ–≤
editProfileForm.addEventListener("submit", submitEditProfileForm);
addNewCardForm.addEventListener("submit", addNewCard);

/*
//—Å–ª—É—à–∞—Ç–µ–ª–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ –æ–≤–µ—Ä–ª–µ—é
editProfilePopup.addEventListener("click", function (event) {
  const target = event.target;
  if (target.closest(".pop-up__container")) event.stopPropagation();
  else if (target.closest(".pop-up_content_edit-profile")) closePopup(editProfilePopup);
});

addNewCardPopup.addEventListener("click", function (event) {
  const target = event.target;
  if (target.closest(".pop-up__container")) event.stopPropagation();
  else if (target.closest(".pop-up_content_add-card")) closePopup(addNewCardPopup);
});

fullSizeImagePopup.addEventListener("click", function (event) {
  const target = event.target;
  if (target.closest(".pop-up__container")) event.stopPropagation();
  else if (target.closest(".pop-up_content_image")) closePopup(fullSizeImagePopup);
});
*/

//—Å–ª—É—à–∞—Ç–µ–ª–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–æ–≤ –ø–æ ESC
/*
  document.addEventListener("keyup", (event) => {
  const activePopup = document.querySelector(".pop-up_opened");
  console.log(activePopup);
  if (event.key === "Escape" && activePopup != null) closePopup(activePopup);
});
*/
